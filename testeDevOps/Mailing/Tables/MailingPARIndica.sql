CREATE TABLE [Mailing].[MailingPARIndica] (
    [ID]                        INT           IDENTITY (1, 1) NOT NULL,
    [CodCampanha]               VARCHAR (50)  NULL,
    [NomeCampanha]              VARCHAR (50)  NULL,
    [Produto]                   VARCHAR (100) NULL,
    [Objetivo]                  VARCHAR (100) NULL,
    [CPF]                       VARCHAR (20)  NULL,
    [Nome]                      VARCHAR (100) NULL,
    [DDDTelefone]               VARCHAR (30)  NULL,
    [TipoTelefone]              VARCHAR (50)  NULL,
    [DDD2Telefone2]             VARCHAR (50)  NULL,
    [TipoTelefone2]             VARCHAR (50)  NULL,
    [DDD3Telefone3]             VARCHAR (50)  NULL,
    [TipoTelefone3]             VARCHAR (50)  NULL,
    [Email]                     VARCHAR (100) NULL,
    [Data_de_Nascimento]        VARCHAR (50)  NULL,
    [ProdutoOferta]             VARCHAR (100) NULL,
    [Posse_Produto_GCS]         VARCHAR (100) NULL,
    [Tipo_Cliente]              VARCHAR (100) NULL,
    [Agencia_Vinculo]           VARCHAR (20)  NULL,
    [Agencia_Indicacao]         VARCHAR (20)  NULL,
    [Indicador]                 VARCHAR (100) NULL,
    [AsVens_Indicador]          VARCHAR (100) NULL,
    [Regional_PAR]              VARCHAR (200) NULL,
    [Superintendencia_Regional] VARCHAR (200) NULL,
    [Termino_Vigencia_Atual]    VARCHAR (200) NULL,
    [Campo_X1]                  VARCHAR (200) NULL,
    [Campo_X2]                  VARCHAR (200) NULL,
    [Campo_X3]                  VARCHAR (200) NULL,
    [Campo_X4]                  VARCHAR (200) NULL,
    [Campo_X5]                  VARCHAR (200) NULL,
    [Campo_X6]                  VARCHAR (200) NULL,
    [Campo_X7]                  VARCHAR (200) NULL,
    [Campo_X8]                  VARCHAR (200) NULL,
    [Campo_X9]                  VARCHAR (200) NULL,
    [Campo_X10]                 VARCHAR (200) NULL,
    [Campo_X11]                 VARCHAR (200) NULL,
    [Campo_X12]                 VARCHAR (200) NULL,
    [Campo_X13]                 VARCHAR (200) NULL,
    [Campo_X14]                 VARCHAR (200) NULL,
    [Campo_X15]                 VARCHAR (200) NULL,
    [Campo_X16]                 VARCHAR (200) NULL,
    [Campo_X17]                 VARCHAR (200) NULL,
    [Campo_X18]                 VARCHAR (200) NULL,
    [Campo_X19]                 VARCHAR (200) NULL,
    [Campo_X20]                 VARCHAR (200) NULL,
    [Campo_X21]                 VARCHAR (200) NULL,
    [Campo_X22]                 VARCHAR (200) NULL,
    [Campo_X23]                 VARCHAR (200) NULL,
    [Campo_X24]                 VARCHAR (200) NULL,
    [Campo_X25]                 VARCHAR (200) NULL,
    [Campo_X26]                 VARCHAR (200) NULL,
    [Campo_X27]                 VARCHAR (200) NULL,
    [Campo_X28]                 VARCHAR (200) NULL,
    [Campo_X29]                 VARCHAR (200) NULL,
    [Campo_X30]                 VARCHAR (200) NULL,
    [Campo_X31]                 VARCHAR (200) NULL,
    [Campo_X32]                 VARCHAR (200) NULL,
    [Campo_X33]                 VARCHAR (200) NULL,
    [Campo_X34]                 VARCHAR (200) NULL,
    [Campo_X35]                 VARCHAR (200) NULL,
    [Campo_X36]                 VARCHAR (200) NULL,
    [Campo_X37]                 VARCHAR (200) NULL,
    [Campo_X38]                 VARCHAR (200) NULL,
    [Campo_X39]                 VARCHAR (200) NULL,
    [Campo_X40]                 VARCHAR (200) NULL,
    [Campo_X41]                 VARCHAR (200) NULL,
    [Campo_X42]                 VARCHAR (200) NULL,
    [NomeArquivo]               VARCHAR (200) NULL,
    [DataHoraImportacao]        DATETIME2 (7) DEFAULT (getdate()) NULL,
    [DataArquivo2]              AS            (CONVERT([date],(('20'+substring([nomearquivo],(2),(2)))+substring([nomearquivo],(4),(2)))+substring([nomearquivo],(6),(2)),(112))) PERSISTED,
    [DataArquivo]               AS            (CONVERT([date],(((('20'+substring([nomearquivo],(2),(2)))+'-')+substring([nomearquivo],(4),(2)))+'-')+substring([nomearquivo],(6),(2)),(111))) PERSISTED,
    PRIMARY KEY CLUSTERED ([ID] ASC) WITH (FILLFACTOR = 100, DATA_COMPRESSION = PAGE)
);


GO
CREATE NONCLUSTERED INDEX [IDX_NCL_DataArquivo_MailingPARIndica]
    ON [Mailing].[MailingPARIndica]([DataArquivo] ASC)
    INCLUDE([CPF]) WITH (FILLFACTOR = 100, DATA_COMPRESSION = PAGE ON PARTITIONS (1), DATA_COMPRESSION = PAGE ON PARTITIONS (2), DATA_COMPRESSION = PAGE ON PARTITIONS (3), DATA_COMPRESSION = PAGE ON PARTITIONS (4), DATA_COMPRESSION = PAGE ON PARTITIONS (5), DATA_COMPRESSION = PAGE ON PARTITIONS (6), DATA_COMPRESSION = PAGE ON PARTITIONS (7), DATA_COMPRESSION = PAGE ON PARTITIONS (8), DATA_COMPRESSION = PAGE ON PARTITIONS (9), DATA_COMPRESSION = PAGE ON PARTITIONS (10), DATA_COMPRESSION = PAGE ON PARTITIONS (11), DATA_COMPRESSION = PAGE ON PARTITIONS (12), DATA_COMPRESSION = PAGE ON PARTITIONS (13), DATA_COMPRESSION = PAGE ON PARTITIONS (14), DATA_COMPRESSION = PAGE ON PARTITIONS (15), DATA_COMPRESSION = PAGE ON PARTITIONS (16), DATA_COMPRESSION = PAGE ON PARTITIONS (17), DATA_COMPRESSION = PAGE ON PARTITIONS (18), DATA_COMPRESSION = PAGE ON PARTITIONS (19), DATA_COMPRESSION = PAGE ON PARTITIONS (20), DATA_COMPRESSION = PAGE ON PARTITIONS (21), DATA_COMPRESSION = PAGE ON PARTITIONS (22), DATA_COMPRESSION = PAGE ON PARTITIONS (23), DATA_COMPRESSION = PAGE ON PARTITIONS (24), DATA_COMPRESSION = PAGE ON PARTITIONS (25), DATA_COMPRESSION = PAGE ON PARTITIONS (26), DATA_COMPRESSION = PAGE ON PARTITIONS (27), DATA_COMPRESSION = PAGE ON PARTITIONS (28), DATA_COMPRESSION = PAGE ON PARTITIONS (29), DATA_COMPRESSION = PAGE ON PARTITIONS (30), DATA_COMPRESSION = PAGE ON PARTITIONS (31), DATA_COMPRESSION = PAGE ON PARTITIONS (32), DATA_COMPRESSION = PAGE ON PARTITIONS (33), DATA_COMPRESSION = PAGE ON PARTITIONS (34), DATA_COMPRESSION = PAGE ON PARTITIONS (35), DATA_COMPRESSION = PAGE ON PARTITIONS (36), DATA_COMPRESSION = PAGE ON PARTITIONS (37), DATA_COMPRESSION = PAGE ON PARTITIONS (38), DATA_COMPRESSION = PAGE ON PARTITIONS (39), DATA_COMPRESSION = PAGE ON PARTITIONS (40), DATA_COMPRESSION = PAGE ON PARTITIONS (41), DATA_COMPRESSION = PAGE ON PARTITIONS (42), DATA_COMPRESSION = PAGE ON PARTITIONS (43), DATA_COMPRESSION = PAGE ON PARTITIONS (44), DATA_COMPRESSION = PAGE ON PARTITIONS (45), DATA_COMPRESSION = PAGE ON PARTITIONS (46), DATA_COMPRESSION = PAGE ON PARTITIONS (47), DATA_COMPRESSION = PAGE ON PARTITIONS (48), DATA_COMPRESSION = PAGE ON PARTITIONS (49), DATA_COMPRESSION = PAGE ON PARTITIONS (50), DATA_COMPRESSION = PAGE ON PARTITIONS (51), DATA_COMPRESSION = PAGE ON PARTITIONS (52), DATA_COMPRESSION = PAGE ON PARTITIONS (53), DATA_COMPRESSION = PAGE ON PARTITIONS (54), DATA_COMPRESSION = PAGE ON PARTITIONS (55), DATA_COMPRESSION = PAGE ON PARTITIONS (56), DATA_COMPRESSION = PAGE ON PARTITIONS (57), DATA_COMPRESSION = PAGE ON PARTITIONS (58), DATA_COMPRESSION = PAGE ON PARTITIONS (59), DATA_COMPRESSION = PAGE ON PARTITIONS (60), DATA_COMPRESSION = PAGE ON PARTITIONS (61), DATA_COMPRESSION = PAGE ON PARTITIONS (62), DATA_COMPRESSION = PAGE ON PARTITIONS (63), DATA_COMPRESSION = PAGE ON PARTITIONS (64), DATA_COMPRESSION = PAGE ON PARTITIONS (65), DATA_COMPRESSION = PAGE ON PARTITIONS (66), DATA_COMPRESSION = PAGE ON PARTITIONS (67), DATA_COMPRESSION = PAGE ON PARTITIONS (68), DATA_COMPRESSION = PAGE ON PARTITIONS (69), DATA_COMPRESSION = PAGE ON PARTITIONS (70), DATA_COMPRESSION = PAGE ON PARTITIONS (71), DATA_COMPRESSION = PAGE ON PARTITIONS (72), DATA_COMPRESSION = PAGE ON PARTITIONS (73), DATA_COMPRESSION = PAGE ON PARTITIONS (74), DATA_COMPRESSION = PAGE ON PARTITIONS (75), DATA_COMPRESSION = PAGE ON PARTITIONS (76), DATA_COMPRESSION = PAGE ON PARTITIONS (77), DATA_COMPRESSION = PAGE ON PARTITIONS (78), DATA_COMPRESSION = PAGE ON PARTITIONS (79), DATA_COMPRESSION = PAGE ON PARTITIONS (80), DATA_COMPRESSION = PAGE ON PARTITIONS (81), DATA_COMPRESSION = PAGE ON PARTITIONS (82), DATA_COMPRESSION = PAGE ON PARTITIONS (83), DATA_COMPRESSION = PAGE ON PARTITIONS (84), DATA_COMPRESSION = PAGE ON PARTITIONS (85), DATA_COMPRESSION = PAGE ON PARTITIONS (86), DATA_COMPRESSION = PAGE ON PARTITIONS (87), DATA_COMPRESSION = PAGE ON PARTITIONS (88), DATA_COMPRESSION = PAGE ON PARTITIONS (89), DATA_COMPRESSION = PAGE ON PARTITIONS (90), DATA_COMPRESSION = PAGE ON PARTITIONS (91), DATA_COMPRESSION = PAGE ON PARTITIONS (92), DATA_COMPRESSION = PAGE ON PARTITIONS (93), DATA_COMPRESSION = PAGE ON PARTITIONS (94), DATA_COMPRESSION = PAGE ON PARTITIONS (95), DATA_COMPRESSION = PAGE ON PARTITIONS (96), DATA_COMPRESSION = PAGE ON PARTITIONS (97), DATA_COMPRESSION = PAGE ON PARTITIONS (98), DATA_COMPRESSION = PAGE ON PARTITIONS (99), DATA_COMPRESSION = PAGE ON PARTITIONS (100), DATA_COMPRESSION = PAGE ON PARTITIONS (101), DATA_COMPRESSION = PAGE ON PARTITIONS (102), DATA_COMPRESSION = PAGE ON PARTITIONS (103), DATA_COMPRESSION = PAGE ON PARTITIONS (104), DATA_COMPRESSION = PAGE ON PARTITIONS (105), DATA_COMPRESSION = PAGE ON PARTITIONS (106), DATA_COMPRESSION = PAGE ON PARTITIONS (107), DATA_COMPRESSION = PAGE ON PARTITIONS (108), DATA_COMPRESSION = PAGE ON PARTITIONS (109), DATA_COMPRESSION = PAGE ON PARTITIONS (110), DATA_COMPRESSION = PAGE ON PARTITIONS (111), DATA_COMPRESSION = PAGE ON PARTITIONS (112), DATA_COMPRESSION = PAGE ON PARTITIONS (113), DATA_COMPRESSION = PAGE ON PARTITIONS (114), DATA_COMPRESSION = PAGE ON PARTITIONS (115), DATA_COMPRESSION = PAGE ON PARTITIONS (116), DATA_COMPRESSION = PAGE ON PARTITIONS (117), DATA_COMPRESSION = PAGE ON PARTITIONS (118), DATA_COMPRESSION = PAGE ON PARTITIONS (119), DATA_COMPRESSION = PAGE ON PARTITIONS (120), DATA_COMPRESSION = PAGE ON PARTITIONS (121), DATA_COMPRESSION = PAGE ON PARTITIONS (122), DATA_COMPRESSION = PAGE ON PARTITIONS (123), DATA_COMPRESSION = PAGE ON PARTITIONS (124), DATA_COMPRESSION = PAGE ON PARTITIONS (125), DATA_COMPRESSION = PAGE ON PARTITIONS (126), DATA_COMPRESSION = PAGE ON PARTITIONS (127), DATA_COMPRESSION = PAGE ON PARTITIONS (128), DATA_COMPRESSION = PAGE ON PARTITIONS (129), DATA_COMPRESSION = PAGE ON PARTITIONS (130), DATA_COMPRESSION = PAGE ON PARTITIONS (131), DATA_COMPRESSION = PAGE ON PARTITIONS (132), DATA_COMPRESSION = PAGE ON PARTITIONS (133), DATA_COMPRESSION = PAGE ON PARTITIONS (134), DATA_COMPRESSION = PAGE ON PARTITIONS (135), DATA_COMPRESSION = PAGE ON PARTITIONS (136), DATA_COMPRESSION = PAGE ON PARTITIONS (137), DATA_COMPRESSION = PAGE ON PARTITIONS (138), DATA_COMPRESSION = PAGE ON PARTITIONS (139), DATA_COMPRESSION = PAGE ON PARTITIONS (140), DATA_COMPRESSION = PAGE ON PARTITIONS (141), DATA_COMPRESSION = PAGE ON PARTITIONS (142), DATA_COMPRESSION = PAGE ON PARTITIONS (143), DATA_COMPRESSION = PAGE ON PARTITIONS (144), DATA_COMPRESSION = PAGE ON PARTITIONS (145), DATA_COMPRESSION = PAGE ON PARTITIONS (146), DATA_COMPRESSION = PAGE ON PARTITIONS (147), DATA_COMPRESSION = PAGE ON PARTITIONS (148), DATA_COMPRESSION = PAGE ON PARTITIONS (149), DATA_COMPRESSION = PAGE ON PARTITIONS (150), DATA_COMPRESSION = PAGE ON PARTITIONS (151))
    ON [PS_DADOS_DataCompetencia] ([DataArquivo]);


GO
CREATE NONCLUSTERED INDEX [ncl_IDX_CpfData_MailingParINDICA]
    ON [Mailing].[MailingPARIndica]([CPF] ASC, [DataArquivo2] ASC) WITH (FILLFACTOR = 100, DATA_COMPRESSION = PAGE);

